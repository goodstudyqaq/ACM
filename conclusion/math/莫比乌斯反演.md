# 莫比乌斯反演
# 前向依赖知识点

# 算法简介

- [http://xiejiadong.com/?p=1173](http://xiejiadong.com/?p=1173)

# 数论函数

定义域为正整数的函数为数论函数

# 积性函数

如果 $\forall a, b, (a,b)=1, f(ab) = f(a)f(b)$ 这样的函数称为积性函数

# 完全积性函数

如果 $\forall a, b, f(ab) = f(a)f(b)$, 这样的函数称为完全积性函数

# Dirichlet 卷积

两个数论函数 $f, g$ 的 Dirichlet 卷积为：$f * g(n) = \sum_{d|n} f(d)g(n/d)$

Dirichlet 卷积的单位元定义为 $e$，则

$$
e(n)=\left\{
\begin{aligned}
1(n = 1) \\
0(n = 0)
\end{aligned}
\right.
$$

## 一些性质

- 交换律，即 $f * g = g * f$
- 结合律，即 $(f * g) * h = f * (g * h)$

# 莫比乌斯函数

如果 $n$ 含有平方因子，那么 $u(n) = 0$，否则 $u(n) = (-1)^k$，$k$ 为 $n$ 不同素因子的个数。

## 一些性质

- $e(n) = \sum_{d|n}u(d)$

证明如下：

设 $n = \prod p_i^{q_i}, n' = \prod p_i$，根据莫比乌斯函数的性质可得 $e(n) = \sum_{d|n}u(d) = \sum_{d|n'}u(d)$

那么进一步转化：

$$
\sum_{d|n'}u(d) = \sum_i^k \begin{pmatrix} k \\ i\end{pmatrix} (-1)^i = \sum_i^k \begin{pmatrix} k \\ i\end{pmatrix} (-1)^i \cdot 1^{k - i} = (-1 + 1) ^ k = 0^k 
$$

当 $n' = 1$ 时，$k = 0$，那么值为 $0^0 = 1$，当 $n' \neq 1$ 时，$k > 0$，那么值为 $0^k = 0$， 与 $e(n)$ 一致。

# 莫比乌斯反演

设 $f(n), g(n)$  为两个数论函数，如果有 $f(n) = \sum_{d|n}g(d)$，那么有 $g(n) = \sum_{d|n}f(d)u(n/d)$

证明如下：

$f(n) = \sum_{d|n} g(d) = g * 1$

又因为 $e = u * 1$，那么在上式两边同乘一个 $u$ 得到 $f * u = g * 1 * u = g * (1 * u) = g * e = g$，得证。

# 代码实现

# 套路总结

## CF 1900 ~ 2100

- [https://codeforces.com/problemset/problem/900/D](https://codeforces.com/problemset/problem/900/D)

## CF 2100 ~ 2300

- 

# 题单

## CF 题单

### 1900 ~ 2100

- [https://codeforces.com/problemset/problem/900/D](https://codeforces.com/problemset/problem/900/D)